# QEDMMA Cross-Correlator Register Map
# Author: Dr. Mladen Mešter
# Copyright (c) 2026 Dr. Mladen Mešter - All Rights Reserved
# SSOT - Single Source of Truth

module:
  name: cross_correlator
  description: "FFT-based Cross-Correlator for TDOA extraction"
  version: "1.0"
  base_address: 0x00020000
  address_width: 12
  data_width: 32

registers:
  - name: CTRL
    offset: 0x00
    description: "Correlator Control Register"
    access: RW
    reset: 0x00000000
    fields:
      - name: ENABLE
        bits: [0]
        description: "Enable correlator"
      - name: START
        bits: [1]
        description: "Start correlation (self-clearing)"
      - name: CONTINUOUS
        bits: [2]
        description: "Continuous mode (auto-restart)"

  - name: FFT_CONFIG
    offset: 0x04
    description: "FFT Configuration"
    access: RW
    reset: 0x00000400
    fields:
      - name: FFT_SIZE
        bits: [12, 0]
        description: "FFT size (256, 512, 1024, 2048, 4096)"

  - name: STATUS
    offset: 0x10
    description: "Correlator Status"
    access: RO
    reset: 0x00000000
    fields:
      - name: BUSY
        bits: [0]
        description: "Correlation in progress"
      - name: DONE
        bits: [1]
        description: "Correlation complete"
      - name: VALID
        bits: [2]
        description: "Valid TDOA result available"

  - name: TDOA_INT
    offset: 0x20
    description: "TDOA Result - Integer Part (signed samples)"
    access: RO
    reset: 0x00000000
    fields:
      - name: TDOA_INT
        bits: [15, 0]
        description: "Signed integer sample offset"

  - name: TDOA_FRAC
    offset: 0x24
    description: "TDOA Result - Fractional Part"
    access: RO
    reset: 0x00000000
    fields:
      - name: TDOA_FRAC
        bits: [15, 0]
        description: "Fractional sample offset (16-bit fixed point)"

  - name: PEAK_MAG
    offset: 0x28
    description: "Peak Magnitude"
    access: RO
    reset: 0x00000000
    fields:
      - name: MAGNITUDE
        bits: [23, 0]
        description: "Correlation peak magnitude"

  - name: VERSION
    offset: 0x3C
    description: "IP Version Register"
    access: RO
    reset: 0x02000000
    fields:
      - name: MAJOR
        bits: [23, 16]
        description: "Major version"
